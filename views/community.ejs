<%- include("partials/header"); -%>

<main>
  <div class="content_box">
    <% forums.forEach(forum => { %>
      <h1>Forum <%= forum.id %></h1>
      <h2><%= forum.title %></h2>
      <p>Details about the forum...</p>
      <div>
        <button onclick="vote(<%= forum.id %>, 'upvote')">Upvote</button>
        <span id="upvotes-<%= forum.id %>"><%= forum.upvotes %></span>
        <button onclick="vote(<%= forum.id %>, 'downvote')">Downvote</button>
        <span id="downvotes-<%= forum.id %>"><%= forum.downvotes %></span>
      </div>
      <hr>
    <% }) %>
  </div>
</main>

<script>
  async function vote(forumId, voteType) {
    const response = await fetch('/vote', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ forumId, voteType })
    });
    const data = await response.json();
    document.getElementById(`upvotes-${forumId}`).innerText = data.upvotes;
    document.getElementById(`downvotes-${forumId}`).innerText = data.downvotes;
  }
</script>

<%- include("partials/footer"); -%>